---
sidebar_position: 1
---

# Docker Concepts

**Docker Platform** — это программа, которая даёт нам возможность упаковывать приложения в контейнеры и запускать их на серверах. Платформа Docker позволяет помещать в контейнеры код и его зависимости. Эти контейнеры могут потом работать на любой операционной системе.

**Docker Engine** — это клиент-серверное приложение.

## Docker Architecture
![Docker Architecture](./img/docker-architecture.png)

**Docker Client** — это основное средство, которое используют для взаимодействия с Docker с помощью `Docker CLI`: в терминал вводят команды, обращаясь к клиенту. Клиент Docker взаимодействует с демоном Docker (dockerd), который выполняет работу по созданию, запуску и распространению контейнеров Docker. Клиент и демон Docker взаимодействуют с помощью `REST API`, через сокеты `UNIX` или сетевой интерфейс. Еще один клиент Docker — `Docker Compose`, который позволяет работать с приложениями, состоящими из набора контейнеров.

**Docker Daemon** — прослушивает запросы `Docker API` и управляет объектами Docker, такими как `Images`, `Containers`, `Networks` и `Volumes`. Демон также может взаимодействовать с другими демонами для управления службами Docker.

**Docker Registries** — хранит образы Docker. Docker Hub — это публичный реестр, который может использовать каждый, и Docker по умолчанию ищет изображения в Docker Hub. Можно запустить свой собственный приватный реестр, например `ECR`.

## Virtualization  vs Containerization 
Контейнеризация (*виртуализация на уровне операционной системы, контейнерная виртуализация, зонная виртуализация*) — метод виртуализации, при котором ядро операционной системы поддерживает несколько изолированных экземпляров пространства пользователя вместо одного. 

Эти экземпляры (*обычно называемые контейнерами или зонами*) с точки зрения выполняемых в них процессов идентичны отдельному экземпляру операционной системы. Для систем на базе `Unix` эта технология похожа на улучшенную реализацию механизма `chroot`. Ядро обеспечивает полную изолированность контейнеров, поэтому программы из разных контейнеров не могут воздействовать друг на друга. 

В отличие от аппаратной виртуализации, при которой эмулируется аппаратное окружение и может быть запущен широкий спектр гостевых операционных систем, в контейнере может быть запущен экземпляр операционной системы только с тем же ядром, что и у хостовой операционной системы (все контейнеры узла используют общее ядро). При этом при контейнеризации отсутствуют дополнительные ресурсные накладные расходы на эмуляцию виртуального оборудования и запуск полноценного экземпляра операционной системы, характерные при аппаратной виртуализации. Существуют реализации, ориентированные на создание практически полноценных экземпляров операционных систем (Solaris Containers, контейнеры Virtuozzo, OpenVZ), так и варианты, фокусирующиеся на изоляции отдельных сервисов с минимальным операционным окружением (jail, Docker).

Есть три типа виртуализации:
- Паравиртуализация
- Эмуляция
- Контейнерная виртуализация

**Гипервизор**, он же монитор виртуальных машин, — это программное обеспечение для создания и запуска виртуальных машин.

## Docker Objects

### Images
Образ — это *read-only* шаблон с инструкциями по созданию Docker-контейнера. Часто изображение основано на другом изображении с некоторой дополнительной настройкой. 

Чтобы создать собственный образ, вы создаете `Dockerfile` с простым синтаксисом для определения шагов, необходимых для создания образа и его запуска. Каждая инструкция в `Dockerfile` создает слой в образе. Когда вы меняете `Dockerfile` и перестраиваете образ, перестраиваются только те слои, которые изменились. Это часть того, что делает образы такими легкими, маленькими и быстрыми по сравнению с другими технологиями виртуализации.

Каждый Docker-образ состоит из слоёв (`layers`), каждый из которых описывает какую-то инструкцию. Далее – Docker объединяет информацию из каждого слоя, и создает шаблон-образ, из которого запускается контейнер, в котором выполняются инструкции из каждого слоя, который был включен в данный образ. Каждый слой описывает какое-то изменение, которое должно быть выполнено с данными на запущенном контейнере. 

Каждая команда в `Dockerfile` – это слой.

### Containers
Контейнер — это работоспособный экземпляр образа. Вы можете создавать, запускать, останавливать, перемещать или удалять контейнер с помощью Docker API или CLI. Вы можете подключить контейнер к одной или нескольким сетям, подключить к нему хранилище или даже создать новый образ на основе его текущего состояния.

Все возможные состояния контейнера Docker:
- **Created**: контейнер создан, но не активен.
- **Restarting**: контейнер в процессе перезапуска.
- **Running**: контейнер работает.
- **Paused**: контейнер приостановлен.
- **Exited**: контейнер закончил свою работу.
- **Dead**: контейнер, который сервис попытался остановить, но не смог
:::note Жизненный цикл контейнера:
Создание контейнера -> Работа контейнера -> 
Приостановка контейнера -> Возобновление работы контейнера ->
Запуск контейнера -> Остановка контейнера -> Перезапуск контейнера ->
Принудительная остановка контейнера -> Удаление контейнера.
:::

### Networks


### Volumes


### Plugins

## Docker inspect 


## Docker Inside Docker (DinD)


## Docker Outside of Docker (DooD)

